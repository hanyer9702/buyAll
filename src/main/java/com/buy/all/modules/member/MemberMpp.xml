<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.buy.all.modules.member.MemberMpp">

    <resultMap id="resultMapObj" type="com.buy.all.modules.member.Member"></resultMap>
	
	<!-- 로그인 시작 -->
	<select id="selectOneLogin" resultMap="resultMapObj">
		SELECT
			a.ifmmSeq
			,a.ifmmId
			,a.ifmmName 
		FROM
			infrMember a
		WHERE 1=1
			AND a.ifmmId = #{ifmmId}
			AND a.ifmmPassword = #{ifmmPassword}
	</select>
	<!-- 로그인 끝 -->
	
	<!-- 회원가입 앞 -->
	
	<insert id="insertMember">
		INSERT INTO infrMember(
			ifmmId
			, ifmmPassword
			, ifmmName
			, ifmmNickname
			, ifmmServiceConsentNy
			, ifmmPersonalConsentNy
			, ifmmDelNy
			, regDateTime
			, modDateTime
		) VALUES (
			#{ifmmId}
			, #{ifmmPassword}
			, #{ifmmName}
			, #{ifmmNickname}
			, #{ifmmServiceConsentNy}
			, #{ifmmPersonalConsentNy}
			, 0
			, #{regDateTime}
			, #{modDateTime}
		)
		<selectKey resultType="string" keyProperty="ifmmSeq" order="AFTER">
			SELECT last_insert_id()
		</selectKey>
	</insert>
	
	<insert id="insertMemberEmail">
		INSERT INTO infrMemberEmail(
			ifmmSeq
			,ifmeEmailFull
			,ifmeDefaultNy
			,ifmeDelNy
			, regDateTime
			, modDateTime
		) VALUES (
			#{ifmmSeq} 
			,#{ifmeEmailFull}
			,1
			,0
			, #{regDateTime}
			, #{modDateTime}
		)
	</insert>
	
	<!-- 회원가입 끝 -->
</mapper>